package com.battleship.core.model.player;

import java.util.ArrayList;
import java.util.List;

import com.battleship.core.enums.NodeState;
import com.battleship.core.model.Position;
import com.battleship.core.model.attack.AttackInventory;
import com.battleship.core.model.attack.AttackResult;
import com.battleship.core.model.board.Board;
import com.battleship.core.model.board.IBoard;
import com.battleship.core.model.board.Node;
import com.battleship.core.model.ship.Ship;
import com.battleship.core.model.state.PlayerState;

public class Player implements IPlayer {
    private final String name;
    private final IBoard board;
    private final AttackInventory inventory;
    private final List<Ship> ships;
    
    public Player(String name) {
        this.name = name;
        this.board = new Board();
        this.inventory = new AttackInventory();
        this.ships = new ArrayList<>();
    }

	@Override
	public String getName() {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public IBoard getBoard() {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public AttackInventory getInventory() {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public void attack(IPlayer opponent, Position position) {
		// TODO Auto-generated method stub
		
	}

	@Override
	public boolean isDefeated() {
		// TODO Auto-generated method stub
		return false;
	}

	@Override
	public void addShip(Ship ship) {
		// TODO Auto-generated method stub
		
	}

	@Override
	public List<Ship> getShips() {
		// TODO Auto-generated method stub
		return null;
	}
    
	public AttackResult receiveAttack(Position position) {
        Node node = board.getNode(position.getX(), position.getY());
        if (node.isHit()) {
            return new AttackResult(false, false, null);
        }
        
        node.setState(NodeState.HIT);
        if (node.hasShip()) {
            Ship ship = node.getShip();
            ship.hit();
            return new AttackResult(true, ship.isSunk(), ship);
        }
        
        node.setState(NodeState.MISS);
        return new AttackResult(false, false, null);
    }
    
    // Thêm phương thức để lấy trạng thái người chơi
    public PlayerState getPlayerState() {
        return new PlayerState(name, board.getBoardState(), inventory);
    }
	
}