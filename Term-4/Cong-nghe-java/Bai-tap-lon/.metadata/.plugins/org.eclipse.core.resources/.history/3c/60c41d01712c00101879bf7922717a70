package com.battleship.core.model.attack;

import java.util.EnumMap;
import java.util.Map;

public class AttackInventory {
    private final Map<AttackType, Integer> weapons;
    private AttackType currentAttackType;  // Thêm trường để lưu loại tấn công hiện tại

    public AttackInventory() {
        this.weapons = new EnumMap<>(AttackType.class);
        this.currentAttackType = AttackType.SINGLE;  // Mặc định là SINGLE
        initializeWeapons();
    }

    private void initializeWeapons() {
        weapons.put(AttackType.SINGLE, 1);
        weapons.put(AttackType.CROSS, 1);
        weapons.put(AttackType.DIAMOND, 1);
        weapons.put(AttackType.RANDOM, 1);
    }

    public boolean hasWeapon(AttackType type) {
        return weapons.getOrDefault(type, 0) > 0;
    }

    public void useWeapon(AttackType type) {
        if (!hasWeapon(type)) {
            throw new IllegalStateException("No weapon of type " + type + " available");
        }
        weapons.put(type, weapons.get(type) - 1);
    }

    // Thêm getter và setter cho currentAttackType
    public AttackType getCurrentAttackType() {
        return currentAttackType;
    }

    public void setCurrentAttackType(AttackType type) {
        if (!hasWeapon(type)) {
            throw new IllegalStateException("No weapon of type " + type + " available");
        }
        this.currentAttackType = type;
    }

    // Thêm phương thức để lấy số lượng vũ khí còn lại
    public int getWeaponCount(AttackType type) {
        return weapons.getOrDefault(type, 0);
    }
}